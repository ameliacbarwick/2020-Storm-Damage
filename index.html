<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storm Damage Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        #map {
            height: 100vh;
            width: 100%;
        }
        #title {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            padding: 10px;
            background-color: #fff;
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000; /* Ensures title appears above the map */
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        .info.legend {
            background: white;
            padding: 10px;
            line-height: 1.5;
        }
        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
    </style>
</head>
<body>

    <div id="title">2020 Total Storm Damage</div>

    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      


    <script>
        // Initialize the map
        const map = L.map('map').setView([37.8, -96], 4); // Center map on the US

        // Add OpenStreetMap tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        // GeoJSON data
        const stormData = {
          "type": "FeatureCollection",
          "features": [
            {
                "type": "Feature",
      "properties": {
        "id": "AK",
        "lat": 58.3019,
        "long": -134.4197,
        "total damage (million$)": 35.85
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -134.4197,
          58.3019
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "AL",
        "lat": 32.8067,
        "long": -86.7911,
        "total damage (million$)": 315.47
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -86.7911,
          32.8067
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "AR",
        "lat": 34.7465,
        "long": -92.2896,
        "total damage (million$)": 0.01
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -92.2896,
          34.7465
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "AZ",
        "lat": 33.4484,
        "long": -112.074,
        "total damage (million$)": 315.21
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -112.074,
          33.4484
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "CA",
        "lat": 36.7783,
        "long": -119.4179,
        "total damage (million$)": 3.95
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -119.4179,
          36.7783
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "CO",
        "lat": 39.7392,
        "long": -104.9903,
        "total damage (million$)": 41.49
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -104.9903,
          39.7392
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "CT",
        "lat": 41.6032,
        "long": -73.0877,
        "total damage (million$)": 325.98
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -73.0877,
          41.6032
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "DC",
        "lat": 38.9072,
        "long": -77.0369,
        "total damage (million$)": 56.4
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -77.0369,
          38.9072
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "DE",
        "lat": 39.7391,
        "long": -75.5398,
        "total damage (million$)": 0.56
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -75.5398,
          39.7391
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "GA",
        "lat": 33.749,
        "long": -84.388,
        "total damage (million$)": 451.33
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -84.388,
          33.749
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "HI",
        "lat": 21.3069,
        "long": -157.8583,
        "total damage (million$)": 33.96
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -157.8583,
          21.3069
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "IA",
        "lat": 41.878,
        "long": -93.0977,
        "total damage (million$)": 30.94
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -93.0977,
          41.878
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "ID",
        "lat": 43.615,
        "long": -116.2023,
        "total damage (million$)": 24.96
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -116.2023,
          43.615
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "IL",
        "lat": 40.6331,
        "long": -89.3985,
        "total damage (million$)": 6.57
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -89.3985,
          40.6331
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "IN",
        "lat": 39.7684,
        "long": -86.158,
        "total damage (million$)": 49.46
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -86.158,
          39.7684
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "KS",
        "lat": 39.0997,
        "long": -94.5786,
        "total damage (million$)": 8.62
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -94.5786,
          39.0997
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "KY",
        "lat": 38.1903,
        "long": -84.8701,
        "total damage (million$)": 31.52
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -84.8701,
          38.1903
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "LA",
        "lat": 30.6954,
        "long": -91.1395,
        "total damage (million$)": 28.66
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -91.1395,
          30.6954
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "LC",
        "lat": 42.2136,
        "long": -79.5006,
        "total damage (million$)": "14,667.28"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -79.5006,
          42.2136
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "LE",
        "lat": 42.1097,
        "long": -81.2111,
        "total damage (million$)": 0.03
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -81.2111,
          42.1097
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "LH",
        "lat": 44.211,
        "long": -81.2498,
        "total damage (million$)": 32.24
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -81.2498,
          44.211
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "LM",
        "lat": 43.0731,
        "long": -87.8836,
        "total damage (million$)": 10.05
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -87.8836,
          43.0731
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "LO",
        "lat": 43.6547,
        "long": -77.0004,
        "total damage (million$)": 19.23
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -77.0004,
          43.6547
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "LS",
        "lat": 47.7001,
        "long": -87.5,
        "total damage (million$)": 276.98
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -87.5,
          47.7001
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "MA",
        "lat": 42.3601,
        "long": -71.0589,
        "total damage (million$)": 24.01
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -71.0589,
          42.3601
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "MD",
        "lat": 39.2904,
        "long": -76.6122,
        "total damage (million$)": 24.78
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -76.6122,
          39.2904
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "ME",
        "lat": 44.3073,
        "long": -69.7817,
        "total damage (million$)": 272.27
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -69.7817,
          44.3073
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "MI",
        "lat": 44.3148,
        "long": -85.6024,
        "total damage (million$)": 3.17
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -85.6024,
          44.3148
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "MN",
        "lat": 44.9778,
        "long": -93.265,
        "total damage (million$)": 79.9
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -93.265,
          44.9778
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "MO",
        "lat": 38.5739,
        "long": -92.6033,
        "total damage (million$)": 7.71
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -92.6033,
          38.5739
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "MS",
        "lat": 32.3547,
        "long": -89.3985,
        "total damage (million$)": 31.27
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -89.3985,
          32.3547
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "MT",
        "lat": 46.8797,
        "long": -110.3626,
        "total damage (million$)": 63.96
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -110.3626,
          46.8797
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "NC",
        "lat": 35.7596,
        "long": -79.0193,
        "total damage (million$)": 1.55
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -79.0193,
          35.7596
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "ND",
        "lat": 47.5515,
        "long": -101.002,
        "total damage (million$)": 4.46
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -101.002,
          47.5515
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "NE",
        "lat": 41.1254,
        "long": -98.2688,
        "total damage (million$)": 0.44
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -98.2688,
          41.1254
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "NH",
        "lat": 43.7939,
        "long": -71.2071,
        "total damage (million$)": 70.93
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -71.2071,
          43.7939
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "NJ",
        "lat": 40.0583,
        "long": -74.4057,
        "total damage (million$)": 28.8
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -74.4057,
          40.0583
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "NM",
        "lat": 34.5199,
        "long": -105.8701,
        "total damage (million$)": 18.7
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -105.8701,
          34.5199
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "NV",
        "lat": 38.8026,
        "long": -116.4194,
        "total damage (million$)": "3,671.66"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -116.4194,
          38.8026
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "NY",
        "lat": 40.7128,
        "long": -74.006,
        "total damage (million$)": 13.16
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -74.006,
          40.7128
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "OK",
        "lat": 35.4676,
        "long": -97.5164,
        "total damage (million$)": 13.34
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.5164,
          35.4676
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "OR",
        "lat": 44.9339,
        "long": -123.0351,
        "total damage (million$)": 0.29
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -123.0351,
          44.9339
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "PA",
        "lat": 40.2737,
        "long": -76.8867,
        "total damage (million$)": 125.06
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -76.8867,
          40.2737
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "PH",
        "lat": 39.9526,
        "long": -75.1652,
        "total damage (million$)": 12.34
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -75.1652,
          39.9526
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "PR",
        "lat": 18.2208,
        "long": -66.5901,
        "total damage (million$)": "1,637.26"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -66.5901,
          18.2208
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "RI",
        "lat": 41.5801,
        "long": -71.5118,
        "total damage (million$)": "2,953.60"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -71.5118,
          41.5801
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "id": "SC",
        "lat": 33.8361,
        "long": -81.1637,
        "total damage (million$)": 13.99
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -81.1637,
          33.8361
        ]
      }
    }
  ]
}

        // Define color scale function based on damage value
        function getColor(d) {
            return d > 300 ? '#800026' :
                   d > 100 ? '#BD0026' :
                   d > 50  ? '#E31A1C' :
                   d > 20  ? '#FC4E2A' :
                   d > 10  ? '#FD8D3C' :
                   d > 5   ? '#FEB24C' :
                             '#FFEDA0';
        }

        // Style each point based on the damage value
        function style(feature) {
            return {
                radius: 8,
                fillColor: getColor(feature.properties["total damage (million$)"]),
                color: "#000",
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8
            };
        }

        // Add points to the map with styles and popups
        L.geoJSON(stormData, {
            pointToLayer: function (feature, latlng) {
                return L.circleMarker(latlng, style(feature));
            },
            onEachFeature: function (feature, layer) {
                layer.bindPopup(
                    `<strong>State:</strong> ${feature.properties.id}<br>
                    <strong>Damage:</strong> $${feature.properties["total damage (million$)"]} million`
                );
            }
        }).addTo(map);

        // Add a legend
        const legend = L.control({ position: 'bottomright' });
        legend.onAdd = function (map) {
            const div = L.DomUtil.create('div', 'legend');
            const grades = [0, 5, 10, 20, 50, 100, 300];
            let labels = ['<strong>Total Damage ($M)</strong>'];

            for (let i = 0; i < grades.length; i++) {
                labels.push(
                    '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
                    grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] : '+')
                );
            }
            div.innerHTML = labels.join('<br>');
            return div;
        };
        legend.addTo(map);

    </script>
</body>
</html>
